 
 //===Create DATABASE=====

create DATABASE Patient_Management_System;
 use Patient_Management_System;
 
 //=====Create patient Table========
 
//=====Insert patients in the Patient Table=========   
CREATE TABLE patients (
    patient_id INT AUTO_INCREMENT PRIMARY KEY,
    name VARCHAR(50),
    dob DATE,
    phone VARCHAR(15) UNIQUE,
    email VARCHAR(50) UNIQUE,
    address VARCHAR(100),
    blood_group VARCHAR(5)
);
     INSERT INTO patients (name,dob,phone,email,address,blood_group)
    -> VALUES ('Shifa','2005-05-05','123456789','shifa@gmail.com','Bhopal','A+');

 INSERT INTO patients (name,dob,phone,email,address,blood_group)
    -> VALUES ('Aliya','2007-01-26','125556789','aliya@gmail.com','Panna','A+');



CREATE TABLE specialties (
    specialty_id INT AUTO_INCREMENT PRIMARY KEY,
    specialty_name VARCHAR(50)
);

CREATE TABLE doctors (
    doctor_id INT AUTO_INCREMENT PRIMARY KEY,
    name VARCHAR(50),
    contact VARCHAR(15),
    consultation_fee DECIMAL(10,2),
    specialty_id INT,
    is_active BOOLEAN DEFAULT TRUE,
    FOREIGN KEY (specialty_id) REFERENCES specialties(specialty_id)
);


CREATE TABLE appointments (
    appointment_id INT AUTO_INCREMENT PRIMARY KEY,
    patient_id INT,
    doctor_id INT,
    appointment_date DATE,
    appointment_time TIME,
    status VARCHAR(20),
    FOREIGN KEY (patient_id) REFERENCES patients(patient_id),
    FOREIGN KEY (doctor_id) REFERENCES doctors(doctor_id)
);

CREATE TABLE visits (
    visit_id INT AUTO_INCREMENT PRIMARY KEY,
    appointment_id INT,
    diagnosis VARCHAR(200),
    notes VARCHAR(200),
    visit_date DATE,
    FOREIGN KEY (appointment_id) REFERENCES appointments(appointment_id)
);

CREATE TABLE prescriptions (
    prescription_id INT AUTO_INCREMENT PRIMARY KEY,
    visit_id INT,
    medicine_name VARCHAR(50),
    dosage VARCHAR(20),
    duration VARCHAR(20),
    FOREIGN KEY (visit_id) REFERENCES visits(visit_id)
);


CREATE TABLE bills (
    bill_id INT AUTO_INCREMENT PRIMARY KEY,
    visit_id INT,
    total_amount DECIMAL(10,2),
    payment_status VARCHAR(20),
    bill_date DATE,
    FOREIGN KEY (visit_id) REFERENCES visits(visit_id)
);

CREATE TABLE payment_transactions (
    payment_id INT AUTO_INCREMENT PRIMARY KEY,
    bill_id INT,
    payment_date DATE,
    payment_mode VARCHAR(20),
    FOREIGN KEY (bill_id) REFERENCES bills(bill_id)
);


CREATE TABLE audit_log (
    log_id INT AUTO_INCREMENT PRIMARY KEY,
    table_name VARCHAR(50),
    operation VARCHAR(20),
    action_time TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);


 SELECT * FROM patients;
+------------+-------+------------+------------+-----------------+---------+-------------+
| patient_id | name  | dob        | phone      | email           | address | blood_group |
+------------+-------+------------+------------+-----------------+---------+-------------+
|          1 | Shifa | 2005-05-05 | 123456789  | shifa@gmail.com | Bhopal  | A+          |
|          2 | Aliya | 2007-01-26 | 125556789  | aliya@gmail.com | Panna   | A+          |
|          3 | Asma  | 2009-03-16 | 9893785201 | asma@gmail.com  | Panna   | B+          |
+------------+-------+------------+------------+-----------------+---------+-------------+
3 rows in set (0.00 sec)

mysql> SELECT * FROM doctors;
+-----------+-----------+------------+------------------+--------------+-----------+
| doctor_id | name      | contact    | consultation_fee | specialty_id | is_active |
+-----------+-----------+------------+------------------+--------------+-----------+
|         1 | Dr. Mehta | 8887776665 |           500.00 |            1 |         1 |
|         2 | Dr. Singh | 9998887776 |           700.00 |            2 |         1 |
|         3 | Dr. Patel | 7776665554 |           600.00 |            3 |         1 |
+-----------+-----------+------------+------------------+--------------+-----------+
3 rows in set (0.00 sec)

mysql> SELECT * FROM appointments;
+----------------+------------+-----------+------------------+------------------+-----------+
| appointment_id | patient_id | doctor_id | appointment_date | appointment_time | status    |
+----------------+------------+-----------+------------------+------------------+-----------+
|              1 |          1 |         1 | 2026-02-09       | 10:00:00         | SCHEDULED |
|              2 |          2 |         2 | 2026-02-09       | 11:00:00         | SCHEDULED |
|              3 |          1 |         3 | 2026-02-09       | 12:00:00         | SCHEDULED |
+----------------+------------+-----------+------------------+------------------+-----------+
3 rows in set (0.00 sec)

mysql> SELECT * FROM visits;
+----------+----------------+-----------+-----------------+------------+
| visit_id | appointment_id | diagnosis | notes           | visit_date |
+----------+----------------+-----------+-----------------+------------+
|        1 |              1 | Fever     | Prescribed rest | 2026-02-09 |
|        2 |              2 | Headache  | MRI advised     | 2026-02-09 |
+----------+----------------+-----------+-----------------+------------+
2 rows in set (0.00 sec)

mysql> SELECT * FROM prescriptions;
+-----------------+----------+---------------+--------+----------+
| prescription_id | visit_id | medicine_name | dosage | duration |
+-----------------+----------+---------------+--------+----------+
|               1 |        1 | Paracetamol   | 500mg  | 5 days   |
|               2 |        1 | Cetrizine     | 10mg   | 3 days   |
|               3 |        2 | Painkiller    | 250mg  | 5 days   |
|               4 |        1 | Paracetamol   | 500mg  | 5 days   |
|               5 |        1 | Cetrizine     | 10mg   | 3 days   |
|               6 |        2 | Painkiller    | 250mg  | 5 days   |
+-----------------+----------+---------------+--------+----------+
6 rows in set (0.00 sec)

mysql> SELECT * FROM bills;
+---------+----------+--------------+----------------+------------+
| bill_id | visit_id | total_amount | payment_status | bill_date  |
+---------+----------+--------------+----------------+------------+
|       1 |        1 |       500.00 | UNPAID         | 2026-02-09 |
|       2 |        2 |       700.00 | PAID           | 2026-02-09 |
+---------+----------+--------------+----------------+------------+
2 rows in set (0.00 sec)


CREATE TABLE appointment_audit (
    ->     audit_id INT AUTO_INCREMENT PRIMARY KEY,
    ->     appointment_id INT,
    ->     action VARCHAR(30),
    ->     action_time TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    ->     FOREIGN KEY (appointment_id) REFERENCES appointments(appointment_id)
    -> );

mysql> INSERT INTO appointment_audit (appointment_id, action)
    -> VALUES (1, 'CREATED');

mysql> INSERT INTO appointment_audit (appointment_id, action)
    -> VALUES (1, 'CANCELLED');

mysql> select * from appointment_audit;
+----------+----------------+-----------+---------------------+
| audit_id | appointment_id | action    | action_time         |
+----------+----------------+-----------+---------------------+
|        1 |              1 | CREATED   | 2026-02-09 13:18:41 |
|        2 |              1 | CANCELLED | 2026-02-09 13:18:41 |
+----------+----------------+-----------+---------------------+
2 rows in set (0.00 sec)


